{"ast":null,"code":"import _slicedToArray from\"/Users/jee/Desktop/j_project/emotiondiary/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _toConsumableArray from\"/Users/jee/Desktop/j_project/emotiondiary/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/Users/jee/Desktop/j_project/emotiondiary/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useReducer,useRef,useEffect}from\"react\";import\"./App.css\";import{BrowserRouter,Routes,Route}from'react-router-dom';import Home from'./pages/Home';import Diary from'./pages/Diary';import New from'./pages/New';import Edit from'./pages/Edit';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){var newState=[];switch(action.type){case\"INIT\":{return action.data;}case\"CREATE\":{var newItem=_objectSpread({},action.data);newState=[newItem].concat(_toConsumableArray(state));break;}case\"REMOVE\":{newState=state.filter(function(it){return it.id!==action.targetId;});break;}case\"EDIT\":{newState=state.map(function(it){return it.id===action.data.id?_objectSpread({},action.data):it;});break;}default:return state;}localStorage.setItem('diary',JSON.stringify(newState));return newState;};export var DiaryStateContext=/*#__PURE__*/React.createContext();export var DiaryDispatchContext=/*#__PURE__*/React.createContext();function App(){var _useReducer=useReducer(reducer,[]),_useReducer2=_slicedToArray(_useReducer,2),data=_useReducer2[0],dispatch=_useReducer2[1];useEffect(function(){var localData=localStorage.getItem(\"diary\");if(localData){var diaryList=JSON.parse(localData).sort(function(a,b){return parseInt(b.id)-parseInt(a.id);});if(diaryList.length>=1){dataId.current=parseInt(diaryList[0].id)+1;dispatch({type:\"INIT\",data:diaryList});}}},[]);var dataId=useRef(0);//CREATE\nvar onCreate=function onCreate(date,content,emotion){dispatch({type:\"CREATE\",data:{id:dataId.current,date:new Date(date).getTime()+new Date(date).getTimezoneOffset()*60*1000,//date: new Date(date).getTime(),\ncontent:content,emotion:emotion}});dataId.current+=1;};//REMOVE\nvar onRemove=function onRemove(targetId){dispatch({type:\"REMOVE\",targetId:targetId});};//EDIT\nvar onEdit=function onEdit(targetId,date,content,emotion){dispatch({type:\"EDIT\",data:{id:targetId,date:new Date(date).getTime()+new Date(date).getTimezoneOffset()*60*1000,//date: new Date(date).getTime(),\ncontent:content,emotion:emotion}});};return/*#__PURE__*/_jsx(DiaryStateContext.Provider,{value:data,children:/*#__PURE__*/_jsx(DiaryDispatchContext.Provider,{value:{onCreate:onCreate,onEdit:onEdit,onRemove:onRemove},children:/*#__PURE__*/_jsx(BrowserRouter,{children:/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/new\",element:/*#__PURE__*/_jsx(New,{})}),/*#__PURE__*/_jsx(Route,{path:\"/edit/:id\",element:/*#__PURE__*/_jsx(Edit,{})}),/*#__PURE__*/_jsx(Route,{path:\"/diary/:id\",element:/*#__PURE__*/_jsx(Diary,{})})]})})})})});};export default App;","map":{"version":3,"names":["React","useReducer","useRef","useEffect","BrowserRouter","Routes","Route","Home","Diary","New","Edit","reducer","state","action","newState","type","data","newItem","filter","it","id","targetId","map","localStorage","setItem","JSON","stringify","DiaryStateContext","createContext","DiaryDispatchContext","App","dispatch","localData","getItem","diaryList","parse","sort","a","b","parseInt","length","dataId","current","onCreate","date","content","emotion","Date","getTime","getTimezoneOffset","onRemove","onEdit"],"sources":["/Users/jee/Desktop/j_project/emotiondiary/src/App.js"],"sourcesContent":["import React, { useReducer, useRef, useEffect } from \"react\";\n\nimport \"./App.css\";\nimport {BrowserRouter, Routes, Route} from 'react-router-dom';\n\nimport Home from './pages/Home';\nimport Diary from './pages/Diary';\nimport New from './pages/New';\nimport Edit from './pages/Edit';\n\nconst reducer = (state, action) => {\n    let newState = [];\n    switch (action.type) {\n        case \"INIT\": {\n            return action.data;\n        }\n        case \"CREATE\": {\n            const newItem = {\n                ...action.data,\n            };\n            newState = [newItem, ...state];\n            break;\n        }\n        case \"REMOVE\": {\n            newState = state.filter((it) => it.id !== action.targetId);\n            break;\n        }\n        case \"EDIT\": {\n            newState = state.map((it) => \n                it.id === action.data.id ? { ...action.data } : it\n            );\n            break;\n        }\n        default:\n            return state;\n    }\n    localStorage.setItem('diary', JSON.stringify(newState));\n    return newState;\n};\n\n\nexport const DiaryStateContext = React.createContext();\nexport const DiaryDispatchContext = React.createContext();\n\n\nfunction App(){\n    const [data, dispatch] = useReducer(reducer, []);\n    useEffect(() => {\n        const localData = localStorage.getItem(\"diary\");\n        if (localData) {\n          const diaryList = JSON.parse(localData).sort(\n            (a, b) => parseInt(b.id) - parseInt(a.id)\n          );\n    \n          if (diaryList.length >= 1) {\n            dataId.current = parseInt(diaryList[0].id) + 1;\n            dispatch({ type: \"INIT\", data: diaryList });\n          }\n        }\n      }, []);\n    const dataId = useRef(0);\n\n    //CREATE\n    const onCreate = (date, content, emotion) => {\n        dispatch({\n            type: \"CREATE\",\n            data: {\n                id: dataId.current,\n                date: new Date(date).getTime() + (new Date(date).getTimezoneOffset() * 60 * 1000),\n                //date: new Date(date).getTime(),\n                content,\n                emotion,\n            },\n        });\n        dataId.current += 1;\n    };\n    //REMOVE\n    const onRemove = (targetId) => {\n        dispatch({type: \"REMOVE\", targetId});\n    }\n    //EDIT\n    const onEdit = (targetId, date, content, emotion) => {\n        dispatch({\n            type: \"EDIT\",\n            data: {\n                id: targetId,\n                date: new Date(date).getTime() + (new Date(date).getTimezoneOffset() * 60 * 1000),\n                //date: new Date(date).getTime(),\n                content,\n                emotion,\n            },\n        });\n    };\n\n\n    return(\n        <DiaryStateContext.Provider value={data}>\n        <DiaryDispatchContext.Provider value={{\n            onCreate,\n            onEdit,\n            onRemove,\n        }}>    \n        <BrowserRouter>\n            <div className=\"App\">\n                <Routes>\n                    <Route path=\"/\" element={<Home />} />\n                    <Route path=\"/new\" element={<New />} />\n                    <Route path=\"/edit/:id\" element={<Edit />} />\n                    <Route path=\"/diary/:id\" element={<Diary />} />\n                </Routes>\n            </div>\n        </BrowserRouter>\n        </DiaryDispatchContext.Provider>\n        </DiaryStateContext.Provider>\n    );\n};\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}